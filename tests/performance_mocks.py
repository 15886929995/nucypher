from unittest.mock import patch

from decorator import contextmanager
from umbral.config import default_params
from umbral.keys import UmbralPublicKey
from umbral.signing import Signature

from nucypher.network.server import make_rest_app

mock_cert_storage = patch("nucypher.config.storages.ForgetfulNodeStorage.store_node_certificate",
                          new=lambda *args, **kwargs: "this_might_normally_be_a_filepath")
mock_message_verification = patch('nucypher.characters.lawful.Alice.verify_from', new=lambda *args, **kwargs: None)


def fake_keep_learning(learner, *args, **kwargs):
    return None

mock_keep_learning = patch('nucypher.network.nodes.Learner.keep_learning_about_nodes', new=fake_keep_learning)

mock_record_fleet_state = patch("nucypher.network.nodes.FleetStateTracker.record_fleet_state",
                                new=lambda *args, **kwargs: None)

serials_which_produce_bytes_which_are_not_viable_as_a_pubkey = [10001, 10003, 10004, 10005, 10007, 10013, 10014, 10018, 10020, 10022, 10029, 10031, 10033, 10034, 10035, 10036, 10037, 10038, 10040, 10041, 10043, 10045, 10049, 10051, 10052, 10053, 10054, 10055, 10056, 10057, 10058, 10060, 10064, 10065, 10068, 10069, 10070, 10071, 10074, 10077, 10078, 10082, 10083, 10086, 10089, 10090, 10091, 10092, 10093, 10095, 10096, 10099, 10100, 10101, 10102, 10103, 10107, 10108, 10110, 10112, 10113, 10116, 10119, 10120, 10122, 10124, 10125, 10128, 10130, 10131, 10134, 10140, 10141, 10142, 10143, 10145, 10146, 10149, 10150, 10151, 10152, 10153, 10154, 10155, 10158, 10159, 10160, 10161, 10164, 10166, 10167, 10169, 10171, 10173, 10174, 10175, 10180, 10184, 10187, 10190, 10191, 10193, 10197, 10198, 10199, 10201, 10202, 10205, 10207, 10209, 10212, 10215, 10218, 10219, 10225, 10226, 10229, 10230, 10233, 10234, 10237, 10239, 10240, 10241, 10243, 10244, 10245, 10251, 10252, 10253, 10260, 10262, 10263, 10264, 10266, 10267, 10269, 10277, 10283, 10284, 10291, 10292, 10293, 10294, 10296, 10297, 10302, 10303, 10305, 10306, 10312, 10315, 10317, 10318, 10319, 10321, 10322, 10326, 10329, 10332, 10340, 10344, 10345, 10348, 10349, 10351, 10352, 10353, 10354, 10355, 10357, 10359, 10360, 10361, 10362, 10363, 10364, 10365, 10367, 10369, 10371, 10373, 10374, 10376, 10377, 10380, 10383, 10385, 10386, 10387, 10388, 10389, 10392, 10393, 10394, 10395, 10396, 10399, 10400, 10403, 10404, 10405, 10406, 10407, 10409, 10410, 10415, 10416, 10418, 10419, 10420, 10424, 10425, 10429, 10430, 10431, 10432, 10433, 10436, 10439, 10440, 10444, 10452, 10454, 10456, 10458, 10463, 10467, 10468, 10470, 10471, 10472, 10473, 10476, 10477, 10478, 10480, 10483, 10488, 10489, 10490, 10493, 10494, 10496, 10497, 10498, 10499, 10501, 10503, 10504, 10507, 10512, 10514, 10515, 10516, 10518, 10522, 10523, 10524, 10526, 10527, 10529, 10531, 10533, 10537, 10538, 10539, 10546, 10547, 10551, 10553, 10554, 10555, 10556, 10557, 10559, 10561, 10563, 10565, 10567, 10568, 10570, 10574, 10575, 10577, 10578, 10580, 10588, 10590, 10592, 10593, 10596, 10598, 10599, 10601, 10602, 10604, 10607, 10609, 10610, 10613, 10616, 10618, 10623, 10624, 10628, 10630, 10631, 10637, 10639, 10640, 10641, 10642, 10643, 10647, 10651, 10652, 10653, 10655, 10656, 10657, 10660, 10661, 10662, 10664, 10666, 10668, 10671, 10674, 10676, 10677, 10679, 10680, 10686, 10692, 10695, 10696, 10697, 10699, 10701, 10703, 10704, 10705, 10707, 10708, 10711, 10713, 10715, 10717, 10722, 10724, 10731, 10732, 10733, 10734, 10736, 10739, 10740, 10741, 10742, 10746, 10747, 10753, 10754, 10755, 10758, 10759, 10761, 10763, 10764, 10765, 10767, 10768, 10771, 10772, 10773, 10774, 10775, 10777, 10779, 10780, 10785, 10786, 10789, 10792, 10793, 10798, 10802, 10803, 10806, 10807, 10808, 10809, 10810, 10812, 10813, 10815, 10816, 10817, 10818, 10821, 10822, 10827, 10828, 10832, 10834, 10836, 10837, 10839, 10844, 10846, 10848, 10849, 10851, 10853, 10855, 10858, 10859, 10860, 10861, 10862, 10863, 10864, 10865, 10866, 10867, 10870, 10872, 10873, 10877, 10878, 10880, 10881, 10883, 10884, 10887, 10889, 10892, 10893, 10895, 10896, 10898, 10899, 10900, 10901, 10902, 10908, 10910, 10915, 10916, 10920, 10921, 10922, 10923, 10924, 10926, 10931, 10932, 10934, 10935, 10936, 10937, 10939, 10940, 10948, 10952, 10953, 10954, 10958, 10959, 10961, 10963, 10964, 10965, 10966, 10968, 10969, 10970, 10972, 10974, 10975, 10976, 10977, 10978, 10979, 10981, 10982, 10983, 10984, 10985, 10986, 10987, 10988, 10992, 10993, 10996, 10997, 10998, 10999, 11001, 11002, 11005, 11010, 11011, 11015, 11016, 11019, 11025, 11026, 11027, 11029, 11030, 11034, 11035, 11039, 11041, 11043, 11046, 11050, 11054, 11055, 11057, 11058, 11064, 11066, 11067, 11068, 11070, 11071, 11073, 11074, 11076, 11078, 11082, 11084, 11086, 11087, 11089, 11092, 11093, 11094, 11095, 11097, 11098, 11100, 11103, 11104, 11105, 11108, 11111, 11114, 11115, 11116, 11118, 11119, 11120, 11122, 11124, 11125, 11127, 11128, 11131, 11132, 11135, 11137, 11139, 11142, 11143, 11145, 11148, 11150, 11151, 11153, 11155, 11156, 11158, 11160, 11164, 11165, 11167, 11169, 11171, 11176, 11179, 11181, 11182, 11183, 11184, 11186, 11187, 11188, 11189, 11194, 11197, 11198, 11200, 11205, 11206, 11208, 11209, 11212, 11213, 11214, 11217, 11221, 11224, 11228, 11230, 11238, 11239, 11241, 11242, 11243, 11245, 11249, 11250, 11251, 11252, 11253, 11259, 11261, 11263, 11264, 11266, 11267, 11272, 11273, 11278, 11279, 11280, 11282, 11283, 11286, 11287, 11289, 11291, 11295, 11296, 11298, 11299, 11304, 11307, 11308, 11309, 11310, 11312, 11319, 11321, 11323, 11327, 11328, 11330, 11331, 11332, 11337, 11340, 11345, 11347, 11349, 11350, 11351, 11352, 11353, 11354, 11355, 11359, 11360, 11361, 11362, 11363, 11364, 11366, 11368, 11369, 11371, 11374, 11377, 11380, 11382, 11383, 11384, 11386, 11387, 11388, 11390, 11393, 11394, 11396, 11398, 11401, 11403, 11406, 11411, 11412, 11417, 11422, 11423, 11428, 11429, 11430, 11431, 11433, 11434, 11435, 11442, 11444, 11449, 11451, 11453, 11456, 11457, 11458, 11461, 11463, 11464, 11465, 11466, 11469, 11470, 11471, 11472, 11476, 11477, 11478, 11479, 11481, 11485, 11488, 11490, 11492, 11494, 11495, 11496, 11498, 11500, 11501, 11502, 11503, 11505, 11509, 11510, 11513, 11514, 11515, 11516, 11518, 11521, 11523, 11524, 11525, 11527, 11530, 11531, 11532, 11533, 11535, 11537, 11538, 11539, 11540, 11544, 11546, 11548, 11551, 11552, 11553, 11559, 11560, 11562, 11564, 11568, 11569, 11575, 11576, 11577, 11579, 11581, 11584, 11585, 11586, 11587, 11591, 11592, 11593, 11596, 11597, 11598, 11600, 11601, 11604, 11605, 11608, 11609, 11610, 11611, 11612, 11616, 11618, 11621, 11622, 11623, 11624, 11628, 11633, 11634, 11637, 11638, 11641, 11642, 11644, 11645, 11646, 11650, 11655, 11658, 11661, 11664, 11665, 11666, 11668, 11670, 11671, 11672, 11673, 11674, 11675, 11679, 11681, 11684, 11685, 11687, 11688, 11689, 11690, 11691, 11692, 11695, 11696, 11697, 11698, 11699, 11700, 11701, 11702, 11706, 11709, 11710, 11712, 11716, 11718, 11719, 11724, 11726, 11732, 11733, 11736, 11737, 11738, 11742, 11744, 11745, 11746, 11747, 11748, 11749, 11750, 11751, 11756, 11757, 11759, 11763, 11764, 11768, 11771, 11772, 11773, 11775, 11778, 11779, 11780, 11782, 11784, 11785, 11786, 11787, 11788, 11789, 11790, 11791, 11794, 11798, 11800, 11802, 11804, 11811, 11815, 11818, 11821, 11824, 11829, 11831, 11833, 11834, 11837, 11839, 11840, 11846, 11847, 11848, 11849, 11851, 11852, 11853, 11860, 11863, 11865, 11866, 11867, 11868, 11869, 11870, 11873, 11877, 11878, 11881, 11883, 11885, 11886, 11888, 11889, 11893, 11894, 11895, 11896, 11899, 11902, 11905, 11906, 11909, 11910, 11912, 11913, 11916, 11919, 11920, 11924, 11925, 11927, 11931, 11933, 11934, 11936, 11937, 11938, 11943, 11947, 11948, 11953, 11954, 11955, 11956, 11959, 11960, 11963, 11969, 11970, 11972, 11973, 11975, 11980, 11981, 11983, 11985, 11991, 11992, 11996, 11999, 12002, 12003, 12004, 12007, 12008, 12009, 12010, 12011, 12012, 12013, 12014, 12016, 12017, 12018, 12020, 12022, 12026, 12028, 12029, 12030, 12031, 12034, 12036, 12043, 12045, 12047, 12050, 12051, 12053, 12054, 12056, 12057, 12058, 12060, 12061, 12063, 12065, 12067, 12069, 12070, 12071, 12074, 12075, 12076, 12077, 12079, 12080, 12082, 12083, 12084, 12086, 12087, 12089, 12090, 12091, 12092, 12093, 12094, 12095, 12096, 12097, 12098, 12099, 12102, 12103, 12104, 12111, 12113, 12114, 12116, 12122, 12123, 12124, 12125, 12126, 12127, 12128, 12129, 12130, 12132, 12135, 12136, 12137, 12138, 12139, 12140, 12141, 12145, 12147, 12148, 12151, 12152, 12153, 12155, 12156, 12157, 12159, 12164, 12167, 12170, 12171, 12173, 12174, 12176, 12178, 12179, 12181, 12182, 12183, 12185, 12190, 12193, 12194, 12195, 12198, 12200, 12201, 12202, 12204, 12205, 12208, 12211, 12212, 12214, 12215, 12218, 12219, 12221, 12222, 12223, 12226, 12227, 12229, 12230, 12232, 12233, 12238, 12244, 12245, 12246, 12249, 12254, 12255, 12257, 12258, 12262, 12263, 12264, 12265, 12266, 12272, 12273, 12274, 12276, 12277, 12278, 12280, 12281, 12283, 12284, 12286, 12288, 12293, 12294, 12297, 12299, 12300, 12301, 12302, 12303, 12304, 12308, 12309, 12310, 12313, 12314, 12315, 12316, 12317, 12320, 12321, 12323, 12324, 12328, 12330, 12331, 12333, 12334, 12335, 12338, 12339, 12340, 12346, 12350, 12354, 12357, 12360, 12361, 12362, 12363, 12365, 12368, 12369, 12375, 12376, 12378, 12382, 12385, 12386, 12388, 12389, 12396, 12398, 12403, 12404, 12408, 12409, 12411, 12413, 12420, 12421, 12422, 12424, 12426, 12427, 12429, 12431, 12432, 12435, 12436, 12437, 12438, 12442, 12443, 12445, 12446, 12447, 12448, 12455, 12457, 12458, 12460, 12463, 12464, 12466, 12467, 12468, 12469, 12470, 12472, 12473, 12474, 12475, 12476, 12480, 12481, 12484, 12485, 12486, 12487, 12489, 12490, 12491, 12492, 12496, 12497, 12499, 12502, 12504, 12505, 12507, 12508, 12509, 12514, 12515, 12516, 12518, 12520, 12521, 12523, 12540, 12544, 12546, 12548, 12549, 12553, 12555, 12556, 12558, 12559, 12560, 12563, 12564, 12566, 12568, 12569, 12572, 12574, 12575, 12576, 12577, 12579, 12580, 12581, 12582, 12585, 12586, 12587, 12589, 12590, 12591, 12593, 12597, 12599, 12601, 12602, 12604, 12605, 12607, 12608, 12609, 12610, 12613, 12615, 12616, 12617, 12620, 12623, 12624, 12631, 12632, 12633, 12634, 12635, 12636, 12637, 12638, 12639, 12640, 12644, 12648, 12650, 12651, 12652, 12657, 12658, 12659, 12663, 12665, 12666, 12667, 12668, 12669, 12672, 12676, 12679, 12680, 12681, 12682, 12683, 12684, 12685, 12687, 12688, 12690, 12691, 12693, 12694, 12697, 12699, 12702, 12703, 12705, 12708, 12709, 12710, 12712, 12714, 12715, 12716, 12721, 12728, 12730, 12731, 12732, 12735, 12738, 12739, 12742, 12746, 12748, 12750, 12753, 12755, 12757, 12758, 12764, 12765, 12774, 12776, 12778, 12779, 12781, 12785, 12786, 12787, 12788, 12791, 12799, 12800, 12802, 12804, 12805, 12808, 12813, 12816, 12817, 12818, 12819, 12820, 12824, 12825, 12827, 12828, 12830, 12831, 12832, 12833, 12836, 12838, 12839, 12840, 12841, 12843, 12844, 12847, 12848, 12850, 12851, 12853, 12855, 12857, 12858, 12860, 12862, 12864, 12865, 12866, 12867, 12868, 12870, 12875, 12876, 12877, 12878, 12879, 12881, 12882, 12883, 12889, 12890, 12891, 12892, 12893, 12898, 12902, 12904, 12905, 12908, 12909, 12910, 12911, 12916, 12917, 12918, 12919, 12920, 12922, 12923, 12925, 12926, 12927, 12928, 12931, 12934, 12935, 12938, 12942, 12943, 12944, 12945, 12951, 12952, 12953, 12954, 12955, 12956, 12957, 12958, 12960, 12961, 12962, 12963, 12965, 12966, 12969, 12970, 12971, 12976, 12977, 12980, 12982, 12983, 12984, 12985, 12991, 12992, 12994, 12996, 13003, 13004, 13005, 13006, 13007, 13010, 13011, 13013, 13015, 13016, 13018, 13021, 13022, 13025, 13028, 13030, 13031, 13033, 13034, 13036, 13038, 13039, 13041, 13045, 13046, 13049, 13051, 13052, 13054, 13055, 13057, 13058, 13059, 13061, 13062, 13063, 13067, 13071, 13072, 13078, 13081, 13082, 13084, 13087, 13090, 13091, 13093, 13095, 13096, 13098, 13099, 13100, 13101, 13102, 13103, 13105, 13106, 13108, 13109, 13112, 13114, 13115, 13116, 13118, 13120, 13121, 13123, 13124, 13125, 13126, 13129, 13130, 13131, 13132, 13133, 13134, 13136, 13137, 13138, 13139, 13141, 13144, 13145, 13146, 13148, 13149, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13160, 13161, 13164, 13165, 13166, 13167, 13168, 13172, 13173, 13177, 13178, 13179, 13180, 13182, 13184, 13185, 13190, 13194, 13195, 13199, 13200, 13201, 13203, 13205, 13206, 13212, 13214, 13216, 13217, 13218, 13219, 13220, 13221, 13225, 13226, 13227, 13241, 13242, 13243, 13244, 13245, 13247, 13253, 13256, 13257, 13258, 13259, 13261, 13262, 13263, 13265, 13267, 13269, 13271, 13272, 13274, 13276, 13277, 13279, 13280, 13282, 13284, 13285, 13286, 13287, 13290, 13293, 13294, 13296, 13298, 13302, 13305, 13308, 13309, 13310, 13311, 13317, 13318, 13320, 13322, 13323, 13325, 13327, 13329, 13330, 13333, 13338, 13339, 13340, 13342, 13345, 13346, 13347, 13350, 13353, 13355, 13357, 13358, 13359, 13364, 13365, 13366, 13368, 13372, 13374, 13376, 13379, 13380, 13383, 13384, 13386, 13388, 13389, 13390, 13392, 13393, 13394, 13395, 13396, 13398, 13399, 13402, 13403, 13405, 13406, 13408, 13410, 13412, 13414, 13416, 13417, 13419, 13421, 13422, 13423, 13425, 13428, 13432, 13434, 13435, 13437, 13438, 13439, 13440, 13442, 13443, 13444, 13445, 13452, 13453, 13454, 13455, 13457, 13458, 13459, 13462, 13464, 13465, 13470, 13474, 13477, 13479, 13482, 13484, 13486, 13488, 13489, 13491, 13492, 13497, 13499, 13501, 13502, 13503, 13505, 13506, 13507, 13510, 13511, 13514, 13517, 13521, 13522, 13524, 13525, 13527, 13529, 13531, 13533, 13534, 13535, 13539, 13540, 13544, 13546, 13547, 13552, 13553, 13554, 13562, 13565, 13570, 13575, 13576, 13577, 13578, 13581, 13582, 13583, 13585, 13587, 13589, 13591, 13592, 13593, 13597, 13598, 13600, 13601, 13602, 13603, 13605, 13607, 13609, 13610, 13617, 13619, 13620, 13624, 13625, 13631, 13634, 13637, 13640, 13641, 13643, 13644, 13645, 13648, 13653, 13656, 13658, 13659, 13661, 13662, 13669, 13670, 13671, 13672, 13674, 13676, 13681, 13684, 13686, 13687, 13690, 13691, 13697, 13698, 13700, 13702, 13704, 13708, 13710, 13711, 13713, 13715, 13719, 13722, 13723, 13724, 13725, 13732, 13733, 13734, 13735, 13741, 13742, 13744, 13746, 13747, 13748, 13754, 13755, 13757, 13759, 13762, 13766, 13770, 13771, 13772, 13774, 13778, 13780, 13781, 13783, 13784, 13785, 13789, 13790, 13792, 13793, 13794, 13795, 13796, 13799, 13801, 13803, 13804, 13806, 13808, 13810, 13811, 13817, 13819, 13820, 13826, 13828, 13834, 13835, 13837, 13838, 13839, 13841, 13842, 13844, 13845, 13846, 13854, 13855, 13860, 13861, 13863, 13864, 13867, 13868, 13869, 13870, 13872, 13876, 13879, 13881, 13884, 13888, 13890, 13895, 13896, 13897, 13899, 13901, 13903, 13905, 13906, 13907, 13913, 13915, 13918, 13920, 13921, 13923, 13924, 13929, 13930, 13931, 13935, 13937, 13938, 13939, 13942, 13946, 13948, 13949, 13950, 13951, 13953, 13959, 13961, 13962, 13963, 13965, 13968, 13969, 13978, 13980, 13982, 13990, 13991, 13992, 13994, 13995, 13996, 13998, 13999, 14000, 14005, 14008, 14010, 14012, 14015, 14016, 14018, 14019, 14025, 14027, 14028, 14031, 14032, 14034, 14035, 14036, 14038, 14039, 14040, 14041, 14044, 14045, 14047, 14048, 14049, 14050, 14051, 14052, 14055, 14056, 14058, 14063, 14064, 14066, 14068, 14070, 14071, 14072, 14073, 14074, 14078, 14083, 14084, 14085, 14089, 14090, 14091, 14093, 14094, 14096, 14097, 14098, 14099, 14100, 14101, 14102, 14106, 14109, 14110, 14111, 14119, 14120, 14121, 14122, 14123, 14124, 14125, 14126, 14128, 14130, 14132, 14133, 14134, 14136, 14137, 14138, 14140, 14143, 14144, 14146, 14147, 14148, 14151, 14152, 14157, 14167, 14168, 14169, 14171, 14173, 14177, 14179, 14181, 14184, 14185, 14188, 14189, 14190, 14191, 14197, 14200, 14201, 14203, 14206, 14208, 14211, 14212, 14213, 14216, 14218, 14220, 14222, 14227, 14228, 14229, 14230, 14231, 14232, 14233, 14234, 14235, 14237, 14239, 14243, 14245, 14247, 14248, 14252, 14258, 14261, 14264, 14265, 14266, 14267, 14268, 14269, 14271, 14275, 14277, 14278, 14280, 14281, 14282, 14283, 14284, 14285, 14286, 14289, 14290, 14292, 14293, 14294, 14296, 14297, 14302, 14307, 14309, 14310, 14311, 14314, 14316, 14317, 14318, 14326, 14331, 14332, 14334, 14338, 14341, 14343, 14346, 14348, 14349, 14350, 14352, 14353, 14354, 14356, 14359, 14361, 14362, 14365, 14367, 14369, 14370, 14371, 14373, 14376, 14377, 14382, 14384, 14386, 14387, 14388, 14391, 14392, 14393, 14394, 14396, 14399, 14400, 14401, 14403, 14404, 14405, 14407, 14409, 14410, 14411, 14412, 14414, 14415, 14416, 14419, 14420, 14423, 14424, 14426, 14427, 14429, 14431, 14433, 14434, 14436, 14437, 14439, 14440, 14441, 14442, 14443, 14444, 14446, 14449, 14455, 14457, 14458, 14460, 14461, 14464, 14468, 14469, 14470, 14471, 14475, 14476, 14480, 14482, 14483, 14485, 14486, 14488, 14492, 14495, 14496, 14497, 14498, 14499, 14501, 14502, 14504, 14505, 14506, 14509, 14510, 14511, 14514, 14516, 14517, 14518, 14519, 14521, 14526, 14529, 14530, 14534, 14535, 14537, 14538, 14539, 14541, 14543, 14544, 14545, 14546, 14551, 14552, 14555, 14558, 14562, 14563, 14564, 14568, 14569, 14571, 14572, 14573, 14575, 14578, 14579, 14580, 14581, 14584, 14586, 14590, 14591, 14593, 14594, 14595, 14596, 14597, 14598, 14599, 14600, 14603, 14606, 14609, 14611, 14613, 14617, 14619, 14620, 14622, 14624, 14627, 14629, 14631, 14633, 14634, 14635, 14637, 14640, 14644, 14645, 14647, 14648, 14652, 14654, 14656, 14658, 14659, 14661, 14666, 14668, 14669, 14671, 14673, 14677, 14680, 14681, 14682, 14686, 14688, 14689, 14693, 14695, 14698, 14700, 14701, 14703, 14709, 14711, 14714, 14715, 14716, 14717, 14718, 14719, 14722, 14723, 14725, 14727, 14730, 14731, 14732, 14733, 14734, 14735, 14736, 14739, 14741, 14743, 14750, 14753, 14754, 14755, 14759, 14760, 14761, 14767, 14770, 14771, 14772, 14773, 14777, 14781, 14782, 14783, 14788, 14789, 14790, 14791, 14792, 14795, 14799, 14800, 14807, 14809, 14810, 14813, 14814, 14817, 14819, 14820, 14822, 14823, 14824, 14825, 14827, 14828, 14829, 14830, 14832, 14834, 14835, 14837, 14838, 14840, 14841, 14843, 14844, 14845, 14848, 14849, 14850, 14852, 14853, 14854, 14856, 14857, 14861, 14864, 14867, 14868, 14872, 14873, 14874, 14881, 14884, 14885, 14886, 14887, 14888, 14889, 14890, 14891, 14898, 14899, 14900, 14905, 14906, 14910, 14912, 14915, 14916, 14918, 14919, 14921, 14922, 14923, 14924, 14925, 14926, 14929, 14931, 14932, 14933, 14934, 14935, 14937, 14939, 14941, 14942, 14943, 14947, 14949, 14950, 14958, 14959, 14960, 14964, 14967, 14968, 14969, 14970, 14972, 14973, 14974, 14975, 14978, 14983, 14984, 14985, 14986, 14989, 14991, 14992, 14994, 14997, 14999, 15000, 15002, 15003, 15004, 15005, 15006, 15007, 15010, 15011, 15012, 15013, 15015, 15016, 15020, 15022, 15024, 15026, 15027, 15029, 15033, 15035, 15036, 15037, 15038, 15041, 15042, 15043, 15044, 15045, 15046, 15047, 15048, 15049, 15050, 15052, 15053, 15054, 15056, 15057, 15058, 15059, 15060, 15061, 15063, 15065, 15067, 15069, 15071, 15072, 15076, 15077, 15078, 15080, 15081, 15083, 15087, 15089, 15091, 15093, 15095, 15096, 15097, 15100, 15104, 15105, 15106, 15113, 15120, 15122, 15123, 15125, 15128, 15129, 15130, 15133, 15134, 15138, 15139, 15143, 15144, 15145, 15147, 15148, 15150, 15151, 15152, 15154, 15155, 15161, 15164, 15165, 15167, 15169, 15171, 15173, 15176, 15177, 15181, 15182, 15183, 15186, 15187, 15188, 15190, 15192, 15193, 15203, 15204, 15206, 15209, 15210, 15214, 15215, 15217, 15219, 15221, 15222, 15224, 15225, 15227, 15228, 15229, 15231, 15233, 15235, 15236, 15237, 15238, 15239, 15243, 15244, 15245, 15246, 15247, 15248, 15253, 15254, 15260, 15261, 15263, 15267, 15268, 15269, 15272, 15277, 15278, 15279, 15281, 15283, 15290, 15292, 15293, 15298, 15299, 15300, 15301, 15305, 15306, 15310, 15311, 15315, 15317, 15318, 15319, 15321, 15322, 15323, 15326, 15327, 15328, 15330, 15333, 15336, 15340, 15342, 15343, 15344, 15345, 15346, 15347, 15348, 15349, 15351, 15353, 15354, 15356, 15358, 15359, 15360, 15361, 15362, 15364, 15368, 15369, 15370, 15371, 15373, 15374, 15375, 15377, 15378, 15379, 15380, 15381, 15383, 15384, 15387, 15389, 15390, 15392, 15395, 15396, 15397, 15398, 15401, 15403, 15406, 15407, 15408, 15409, 15410, 15411, 15416, 15421, 15422, 15426, 15427, 15428, 15429, 15430, 15433, 15434, 15435, 15437, 15438, 15439, 15440, 15441, 15446, 15447, 15448, 15451, 15453, 15455, 15456, 15462, 15464, 15468, 15469, 15472, 15475, 15476, 15477, 15480, 15481, 15482, 15484, 15485, 15487, 15489, 15492, 15498, 15501, 15502, 15503, 15504, 15505, 15506, 15508, 15511, 15515, 15521, 15522, 15523, 15524, 15527, 15528, 15530, 15531, 15532, 15535, 15536, 15537, 15538, 15539, 15540, 15542, 15545, 15546, 15547, 15548, 15549, 15554, 15555, 15559, 15563, 15566, 15567, 15569, 15571, 15573, 15574, 15575, 15577, 15578, 15579, 15581, 15582, 15584, 15589, 15590, 15592, 15593, 15594, 15595, 15596, 15601, 15605, 15609, 15613, 15615, 15617, 15619, 15620, 15622, 15624, 15625, 15627, 15631, 15633, 15635, 15639, 15640, 15641, 15645, 15646, 15649, 15654, 15656, 15657, 15658, 15659, 15661, 15664, 15667, 15669, 15671, 15672, 15678, 15681, 15685, 15689, 15690, 15691, 15692, 15693, 15695, 15699, 15700, 15702, 15703, 15704, 15711, 15715, 15719, 15721, 15722, 15724, 15728, 15729, 15730, 15731, 15733, 15734, 15735, 15737, 15738, 15741, 15742, 15744, 15745, 15746, 15747, 15748, 15749, 15750, 15751, 15754, 15756, 15757, 15758, 15759, 15760, 15763, 15765, 15766, 15767, 15769, 15771, 15774, 15776, 15777, 15781, 15782, 15783, 15784, 15785, 15787, 15788, 15790, 15791, 15793, 15795, 15797, 15798, 15804, 15806, 15807, 15808, 15810, 15812, 15813, 15815, 15816, 15817, 15818, 15819, 15820, 15824, 15827, 15828, 15830, 15831, 15833, 15837, 15839, 15840, 15841, 15844, 15847, 15850, 15851, 15853, 15855, 15856, 15857, 15859, 15861, 15865, 15866, 15867, 15869, 15870, 15871, 15872, 15873, 15876, 15877, 15878, 15880, 15881, 15882, 15884, 15885, 15887, 15888, 15889, 15890, 15893, 15894, 15896, 15897, 15898, 15905, 15910, 15911, 15915, 15917, 15918, 15921, 15922, 15925, 15929, 15930, 15932, 15934, 15936, 15937, 15940, 15941, 15942, 15943, 15944, 15947, 15949, 15952, 15953, 15957, 15958, 15961, 15965, 15967, 15969, 15970, 15974, 15976, 15977, 15979, 15980, 15981, 15982, 15983, 15984, 15985, 15988, 15989, 15994, 15997, 15999, 16000, 16001, 16002, 16005, 16007, 16008, 16010, 16012, 16014, 16017, 16018, 16019, 16022, 16023, 16024, 16025, 16029, 16032, 16033, 16038, 16039, 16042, 16048, 16050, 16051, 16052, 16054, 16060, 16061, 16065, 16066, 16070, 16071, 16073, 16075, 16076, 16078, 16079, 16082, 16085, 16086, 16087, 16090, 16092, 16093, 16095, 16097, 16098, 16100, 16103, 16104, 16105, 16106, 16109, 16112, 16114, 16115, 16116, 16118, 16120, 16122, 16124, 16126, 16128, 16133, 16134, 16135, 16144, 16146, 16148, 16151, 16152, 16154, 16155, 16157, 16158, 16164, 16165, 16167, 16169, 16173, 16174, 16178, 16181, 16182, 16184, 16186, 16187, 16192, 16193, 16194, 16195, 16196, 16197, 16198, 16199, 16200, 16201, 16205, 16207, 16209, 16214, 16215, 16218, 16219, 16220, 16221, 16222, 16224, 16226, 16227, 16229, 16230, 16232, 16233, 16234, 16235, 16239, 16241, 16242, 16244, 16247, 16250, 16252, 16254, 16261, 16262, 16263, 16264, 16267, 16274, 16279, 16282, 16285, 16287, 16288, 16293, 16295, 16296, 16297, 16298, 16299, 16300, 16301, 16304, 16306, 16310, 16313, 16316, 16317, 16318, 16320, 16321, 16322, 16325, 16326, 16327, 16328, 16331, 16335, 16336, 16337, 16339, 16341, 16343, 16344, 16345, 16347, 16348, 16350, 16351, 16352, 16353, 16354, 16355, 16360, 16361, 16365, 16366, 16367, 16370, 16372, 16373, 16374, 16377, 16378, 16379, 16380, 16384, 16385, 16386, 16387, 16389, 16394, 16395, 16397, 16399, 16401, 16402, 16407, 16411, 16415, 16416, 16417, 16419, 16425, 16426, 16428, 16431, 16432, 16434, 16436, 16440, 16441, 16442, 16443, 16444, 16445, 16448, 16449, 16450, 16451, 16452, 16453, 16456, 16457, 16459, 16460, 16466, 16468, 16469, 16472, 16473, 16474, 16475, 16476, 16482, 16485, 16487, 16489, 16491, 16492, 16494, 16496, 16497, 16498, 16499, 16500, 16502, 16503, 16509, 16514, 16515, 16518, 16519, 16520, 16521, 16524, 16525, 16526, 16530, 16531, 16532, 16533, 16534, 16535, 16536, 16537, 16538, 16540, 16543, 16544, 16545, 16547, 16548, 16554, 16555, 16556, 16557, 16559, 16560, 16562, 16565, 16567, 16574, 16575, 16579, 16580, 16581, 16582, 16585, 16591, 16594, 16595, 16596, 16598, 16602, 16603, 16604, 16606, 16608, 16609, 16612, 16613, 16614, 16619, 16623, 16624, 16629, 16632, 16634, 16638, 16640, 16641, 16642, 16649, 16650, 16651, 16653, 16654, 16655, 16657, 16658, 16659, 16662, 16664, 16665, 16667, 16670, 16672, 16673, 16674, 16675, 16677, 16680, 16681, 16682, 16683, 16684, 16685, 16688, 16691, 16695, 16697, 16699, 16703, 16706, 16708, 16709, 16711, 16713, 16715, 16716, 16717, 16719, 16722, 16723, 16724, 16725, 16727, 16728, 16729, 16730, 16731, 16732, 16733, 16734, 16736, 16738, 16740, 16743, 16744, 16745, 16746, 16747, 16748, 16749, 16751, 16753, 16757, 16758, 16759, 16762, 16765, 16767, 16768, 16771, 16772, 16776, 16777, 16778, 16780, 16781, 16782, 16784, 16786, 16787, 16789, 16790, 16791, 16792, 16793, 16794, 16797, 16802, 16803, 16805, 16806, 16808, 16809, 16820, 16821, 16822, 16826, 16827, 16828, 16829, 16831, 16834, 16837, 16838, 16839, 16844, 16845, 16847, 16848, 16850, 16851, 16853, 16855, 16856, 16858, 16861, 16865, 16867, 16868, 16873, 16876, 16878, 16881, 16884, 16886, 16889, 16890, 16891, 16893, 16896, 16897, 16898, 16899, 16900, 16901, 16904, 16908, 16909, 16911, 16913, 16916, 16918, 16920, 16921, 16923, 16924, 16925, 16926, 16930, 16931, 16932, 16935, 16936, 16937, 16939, 16942, 16943, 16946, 16949, 16950, 16952, 16959, 16961, 16964, 16966, 16967, 16969, 16971, 16972, 16974, 16976, 16978, 16979, 16981, 16982, 16983, 16984, 16985, 16986, 16987, 16989, 16991, 16992, 16993, 16994, 16996, 16997, 16998, 16999, 17000, 17002, 17003, 17004, 17005, 17006, 17012, 17015, 17016, 17017, 17021, 17022, 17023, 17024, 17026, 17028, 17029, 17030, 17034, 17035, 17036, 17040, 17041, 17042, 17043, 17046, 17047, 17048, 17050, 17052, 17053, 17055, 17057, 17058, 17060, 17061, 17062, 17063, 17065, 17066, 17067, 17068, 17070, 17073, 17074, 17075, 17077, 17078, 17080, 17082, 17083, 17084, 17085, 17086, 17087, 17090, 17092, 17095, 17096, 17097, 17099, 17101, 17102, 17104, 17108, 17110, 17114, 17115, 17117, 17118, 17120, 17121, 17123, 17124, 17125, 17128, 17129, 17134, 17137, 17139, 17141, 17143, 17148, 17149, 17151, 17153, 17154, 17155, 17158, 17159, 17162, 17164, 17166, 17170, 17171, 17172, 17173, 17178, 17182, 17183, 17184, 17185, 17186, 17189, 17190, 17191, 17192, 17193, 17194, 17195, 17196, 17199, 17201, 17202, 17203, 17206, 17210, 17211, 17214, 17215, 17216, 17218, 17219, 17223, 17224, 17228, 17229, 17231, 17232, 17240, 17244, 17247, 17251, 17253, 17257, 17259, 17261, 17263, 17264, 17266, 17268, 17269, 17272, 17273, 17275, 17277, 17279, 17280, 17284, 17287, 17292, 17296, 17297, 17299, 17301, 17302, 17304, 17305, 17307, 17313, 17318, 17323, 17324, 17326, 17327, 17328, 17331, 17333, 17334, 17336, 17337, 17338, 17340, 17342, 17343, 17344, 17350, 17351, 17357, 17358, 17359, 17361, 17364, 17369, 17376, 17381, 17382, 17383, 17384, 17385, 17388, 17389, 17390, 17392, 17394, 17395, 17398, 17399, 17402, 17407, 17408, 17409, 17411, 17412, 17413, 17417, 17419, 17421, 17426, 17427, 17432, 17433, 17434, 17437, 17439, 17440, 17443, 17444, 17446, 17447, 17451, 17452, 17453, 17454, 17455, 17459, 17460, 17461, 17466, 17468, 17469, 17473, 17476, 17477, 17479, 17481, 17487, 17489, 17492, 17494, 17497, 17498, 17501, 17503, 17504, 17509, 17510, 17511, 17512, 17516, 17517, 17519, 17522, 17524, 17527, 17528, 17530, 17531, 17532, 17533, 17535, 17536, 17537, 17538, 17543, 17551, 17552, 17553, 17554, 17557, 17562, 17564, 17565, 17567, 17568, 17569, 17570, 17575, 17578, 17581, 17584, 17590, 17593, 17595, 17599, 17602, 17604, 17609, 17611, 17612, 17614, 17617, 17618, 17621, 17622, 17623, 17625, 17626, 17630, 17633, 17634, 17637, 17638, 17642, 17643, 17644, 17647, 17650, 17652, 17653, 17655, 17656, 17657, 17660, 17661, 17662, 17664, 17665, 17666, 17668, 17669, 17671, 17673, 17675, 17676, 17677, 17678, 17679, 17684, 17685, 17686, 17687, 17688, 17692, 17695, 17698, 17706, 17707, 17708, 17712, 17714, 17716, 17718, 17720, 17721, 17722, 17723, 17724, 17727, 17728, 17729, 17730, 17733, 17736, 17737, 17738, 17739, 17740, 17744, 17745, 17746, 17751, 17754, 17756, 17761, 17762, 17763, 17766, 17768, 17769, 17772, 17773, 17775, 17777, 17781, 17782, 17788, 17792, 17793, 17796, 17797, 17798, 17801, 17802, 17804, 17809, 17813, 17814, 17819, 17821, 17823, 17824, 17828, 17832, 17833, 17835, 17837, 17838, 17839, 17842, 17844, 17845, 17846, 17847, 17850, 17852, 17855, 17856, 17857, 17859, 17861, 17865, 17866, 17867, 17868, 17871, 17872, 17874, 17875, 17876, 17877, 17879, 17880, 17884, 17885, 17886, 17887, 17889, 17891, 17892, 17897, 17899, 17900, 17902, 17904, 17908, 17913, 17914, 17916, 17919, 17922, 17926, 17927, 17928, 17930, 17931, 17932, 17934, 17936, 17938, 17939, 17943, 17944, 17947, 17953, 17955, 17956, 17958, 17959, 17962, 17963, 17964, 17965, 17966, 17968, 17969, 17971, 17975, 17978, 17979, 17980, 17981, 17983, 17984, 17987, 17988, 17993, 17994, 17995, 17996, 17997, 17998, 17999, 18001, 18002, 18004, 18006, 18008, 18009, 18010, 18011, 18014, 18020, 18021, 18022, 18024, 18026, 18031, 18033, 18034, 18035, 18036, 18040, 18042, 18043, 18045, 18046, 18047, 18048, 18049, 18050, 18053, 18055, 18056, 18059, 18064, 18065, 18068, 18069, 18076, 18081, 18082, 18087, 18091, 18092, 18093, 18096, 18097, 18099, 18105, 18106, 18108, 18109, 18110, 18111, 18112, 18113, 18114, 18117, 18118, 18122, 18125, 18126, 18127, 18128, 18129, 18130, 18131, 18133, 18136, 18138, 18140, 18143, 18145, 18146, 18148, 18149, 18152, 18153, 18155, 18156, 18158, 18159, 18160, 18162, 18166, 18168, 18169, 18172, 18177, 18178, 18179, 18182, 18185, 18188, 18192, 18196, 18199, 18200, 18202, 18205, 18206, 18207, 18210, 18211, 18212, 18213, 18214, 18217, 18218, 18219, 18220, 18221, 18222, 18223, 18224, 18226, 18227, 18228, 18230, 18231, 18232, 18234, 18238, 18239, 18240, 18241, 18247, 18251, 18257, 18258, 18261, 18262, 18263, 18264, 18265, 18266, 18267, 18270, 18273, 18277, 18278, 18280, 18281, 18282, 18283, 18284, 18287, 18288, 18289, 18294, 18295, 18297, 18298, 18301, 18309, 18310, 18311, 18312, 18315, 18316, 18321, 18322, 18326, 18327, 18328, 18333, 18334, 18337, 18338, 18339, 18340, 18341, 18342, 18343, 18350, 18352, 18355, 18356, 18357, 18358, 18360, 18361, 18362, 18365, 18367, 18372, 18378, 18381, 18382, 18387, 18388, 18389, 18391, 18395, 18397, 18400, 18406, 18408, 18409, 18410, 18411, 18412, 18413, 18415, 18416, 18417, 18419, 18423, 18424, 18425, 18426, 18428, 18429, 18431, 18432, 18434, 18435, 18439, 18441, 18447, 18448, 18449, 18451, 18453, 18454, 18455, 18456, 18460, 18461, 18462, 18463, 18464, 18466, 18470, 18471, 18472, 18473, 18474, 18475, 18476, 18477, 18478, 18479, 18480, 18481, 18486, 18487, 18488, 18489, 18491, 18492, 18495, 18496, 18497, 18501, 18503, 18506, 18507, 18508, 18509, 18510, 18511, 18518, 18519, 18520, 18522, 18524, 18525, 18529, 18531, 18534, 18538, 18539, 18540, 18544, 18545, 18552, 18553, 18561, 18562, 18563, 18566, 18567, 18570, 18571, 18573, 18574, 18575, 18576, 18580, 18583, 18584, 18585, 18588, 18589, 18590, 18599, 18600, 18601, 18602, 18605, 18606, 18609, 18612, 18614, 18615, 18617, 18620, 18621, 18622, 18623, 18625, 18626, 18628, 18629, 18633, 18642, 18643, 18644, 18649, 18650, 18653, 18655, 18660, 18662, 18663, 18667, 18668, 18671, 18672, 18674, 18677, 18678, 18679, 18682, 18685, 18686, 18689, 18691, 18692, 18695, 18696, 18698, 18699, 18700, 18701, 18703, 18705, 18706, 18710, 18711, 18712, 18713, 18714, 18715, 18716, 18717, 18719, 18723, 18724, 18726, 18729, 18730, 18733, 18735, 18737, 18738, 18742, 18743, 18744, 18751, 18753, 18754, 18755, 18757, 18758, 18759, 18760, 18761, 18762, 18766, 18768, 18769, 18770, 18772, 18773, 18777, 18778, 18782, 18786, 18788, 18791, 18792, 18795, 18799, 18800, 18802, 18803, 18807, 18808, 18809, 18811, 18812, 18813, 18814, 18815, 18816, 18817, 18821, 18827, 18828, 18831, 18832, 18836, 18841, 18843, 18846, 18851, 18852, 18853, 18856, 18858, 18859, 18863, 18865, 18866, 18867, 18869, 18871, 18873, 18874, 18876, 18878, 18879, 18880, 18881, 18884, 18885, 18887, 18888, 18889, 18892, 18893, 18894, 18896, 18897, 18898, 18900, 18902, 18903, 18905, 18908, 18909, 18910, 18918, 18919, 18922, 18924, 18926, 18928, 18930, 18931, 18934, 18937, 18939, 18941, 18944, 18953, 18955, 18959, 18961, 18963, 18964, 18965, 18966, 18967, 18968, 18969, 18970, 18972, 18975, 18976, 18977, 18979, 18980, 18981, 18982, 18985, 18986, 18988, 18990, 18991, 18994, 18996, 18997, 18999, 19000, 19004, 19006, 19008, 19009, 19010, 19011, 19012, 19013, 19014, 19016, 19017, 19018, 19019, 19020, 19021, 19023, 19027, 19028, 19030, 19031, 19035, 19038, 19039, 19041, 19043, 19044, 19049, 19050, 19057, 19062, 19063, 19064, 19067, 19072, 19073, 19074, 19075, 19076, 19077, 19078, 19079, 19082, 19086, 19089, 19094, 19101, 19105, 19106, 19107, 19111, 19112, 19115, 19116, 19124, 19125, 19126, 19128, 19129, 19130, 19137, 19138, 19142, 19144, 19147, 19148, 19149, 19151, 19153, 19155, 19156, 19158, 19159, 19160, 19163, 19166, 19167, 19169, 19171, 19172, 19174, 19176, 19178, 19179, 19183, 19185, 19186, 19187, 19188, 19190, 19193, 19194, 19195, 19196, 19198, 19199, 19200, 19201, 19202, 19204, 19207, 19208, 19209, 19211, 19216, 19217, 19218, 19223, 19227, 19228, 19234, 19236, 19238, 19241, 19243, 19245, 19246, 19250, 19255, 19256, 19259, 19261, 19262, 19263, 19264, 19266, 19267, 19270, 19271, 19275, 19276, 19277, 19279, 19281, 19282, 19284, 19285, 19287, 19292, 19294, 19295, 19296, 19297, 19302, 19304, 19306, 19307, 19309, 19310, 19312, 19314, 19315, 19316, 19317, 19318, 19321, 19322, 19324, 19326, 19327, 19331, 19332, 19333, 19336, 19337, 19338, 19341, 19343, 19344, 19345, 19349, 19351, 19354, 19355, 19356, 19357, 19364, 19369, 19371, 19373, 19377, 19378, 19380, 19382, 19383, 19384, 19386, 19387, 19388, 19394, 19399, 19400, 19402, 19410, 19412, 19413, 19419, 19420, 19421, 19427, 19428, 19429, 19430, 19431, 19432, 19433, 19434, 19437, 19438, 19439, 19442, 19443, 19444, 19447, 19448, 19449, 19454, 19456, 19471, 19472, 19473, 19481, 19482, 19483, 19484, 19485, 19486, 19488, 19490, 19492, 19494, 19496, 19497, 19500, 19503, 19508, 19512, 19516, 19517, 19518, 19519, 19520, 19521, 19522, 19523, 19524, 19529, 19531, 19532, 19533, 19534, 19540, 19541, 19542, 19546, 19548, 19549, 19552, 19555, 19556, 19559, 19567, 19569, 19570, 19571, 19577, 19578, 19581, 19584, 19587, 19589, 19591, 19595, 19600, 19601, 19603, 19605, 19607, 19608, 19609, 19610, 19611, 19614, 19616, 19618, 19619, 19621, 19622, 19627, 19632, 19633, 19634, 19635, 19639, 19643, 19644, 19646, 19647, 19649, 19650, 19652, 19653, 19654, 19657, 19658, 19662, 19663, 19666, 19667, 19668, 19671, 19673, 19679, 19680, 19682, 19687, 19689, 19693, 19695, 19698, 19703, 19704, 19709, 19711, 19712, 19713, 19716, 19718, 19719, 19720, 19721, 19723, 19727, 19729, 19730, 19731, 19732, 19734, 19736, 19742, 19743, 19744, 19746, 19747, 19748, 19750, 19753, 19754, 19755, 19757, 19759, 19760, 19761, 19762, 19764, 19766, 19768, 19772, 19773, 19774, 19775, 19776, 19780, 19786, 19788, 19789, 19790, 19792, 19793, 19794, 19795, 19800, 19803, 19805, 19808, 19809, 19811, 19814, 19815, 19820, 19824, 19826, 19828, 19832, 19835, 19837, 19844, 19845, 19846, 19849, 19857, 19858, 19859, 19861, 19862, 19863, 19864, 19865, 19866, 19867, 19873, 19874, 19875, 19878, 19879, 19880, 19883, 19886, 19887, 19889, 19890, 19891, 19893, 19894, 19896, 19898, 19902, 19903, 19905, 19906, 19909, 19910, 19911, 19914, 19916, 19917, 19921, 19922, 19923, 19927, 19928, 19930, 19937, 19939, 19940, 19943, 19946, 19949, 19950, 19952, 19953, 19955, 19959, 19960, 19962, 19963, 19964, 19965, 19966, 19967, 19968, 19969, 19971, 19972, 19973, 19976, 19977, 19983, 19986, 19989, 19991, 19994, 19997, 19999]

class NotAPublicKey:
    _serial = 10000

    _umbral_pubkey_from_bytes = UmbralPublicKey.from_bytes

    @classmethod
    def tick(cls):
        cls._serial += 1
        while cls._serial in serials_which_produce_bytes_which_are_not_viable_as_a_pubkey:
            cls._serial += 1

    def __init__(self, serial=None):
        if serial is None:
            self.tick()
            self.serial = str(self._serial).encode()
        else:
            self.serial = serial

    def __bytes__(self):
         return b"\x03\ not a compress publickey:" + self.serial

    @classmethod
    def from_bytes(cls, some_bytes):
        return cls(serial=some_bytes[-5:])

    def to_bytes(self, *args, **kwargs):
        return b"this is not a public key... but it is 64 bytes.. so, ya know" + self.serial


class NotAPrivateKey:
    params = default_params()

    fake_signature = Signature.from_bytes(
        b'@\xbfS&\x97\xb3\x9e\x9e\xd3\\j\x9f\x0e\x8fY\x0c\xbeS\x08d\x0b%s\xf6\x17\xe2\xb6\xcd\x95u\xaapON\xd9E\xb3\x10M\xe1\xf4u\x0bL\x99q\xd6\r\x8e_\xe5I\x1e\xe5\xa2\xcf\xe5\x8be_\x077Gz'
    )

    def public_key(self):
        return NotAPublicKey()

    def get_pubkey(self, *args, **kwargs):
        return self.public_key()

    def to_cryptography_privkey(self, *args, **kwargs):
        return self

    def sign(self, *args, **kwargs):
        return b'0D\x02 @\xbfS&\x97\xb3\x9e\x9e\xd3\\j\x9f\x0e\x8fY\x0c\xbeS\x08d\x0b%s\xf6\x17\xe2\xb6\xcd\x95u\xaap\x02 ON\xd9E\xb3\x10M\xe1\xf4u\x0bL\x99q\xd6\r\x8e_\xe5I\x1e\xe5\xa2\xcf\xe5\x8be_\x077Gz'

    @classmethod
    def stamp(cls, *args, **kwargs):
        return cls.fake_signature

    @classmethod
    def signature_bytes(cls, *args, **kwargs):
        return b'@\xbfS&\x97\xb3\x9e\x9e\xd3\\j\x9f\x0e\x8fY\x0c\xbeS\x08d\x0b%s\xf6\x17\xe2\xb6\xcd\x95u\xaapON\xd9E\xb3\x10M\xe1\xf4u\x0bL\x99q\xd6\r\x8e_\xe5I\x1e\xe5\xa2\xcf\xe5\x8be_\x077Gz'


class NotACert:
    class Subject:
        def get_attributes_for_oid(self, *args, **kwargs):
            class Pseudonym:
                value = "0x51347fF6eb8F1D39B83B5e9c244Dc2E1E9EB14B4"

            return Pseudonym(), "Or whatever?"

    subject = Subject()

    def public_bytes(self, does_not_matter):
        return b"this is not a cert."

    def public_key(self):
        return NotAPublicKey()


mock_cert_loading = patch("nucypher.characters.lawful.load_pem_x509_certificate",
                          new=lambda *args, **kwargs: NotACert())


def do_not_create_cert(*args, **kwargs):
    return NotACert(), NotAPrivateKey()


def simple_remember(ursula, node, *args, **kwargs):
    address = node.checksum_address
    ursula.known_nodes[address] = node


class NotARestApp:
    testing = True
    _actual_rest_apps = []
    _replaced_routes = {}

    def __init__(self, this_node, *args, **kwargs):
        self._actual_rest_app = None
        self.this_node = this_node

    @classmethod
    @contextmanager
    def replace_route(cls, route_name, new_route):
        cls._replaced_routes[route_name] = new_route
        yield
        del cls._replaced_routes[route_name]

    class _ViewFunctions:
        def __init__(self, _old_view_functions=None):
            self._view_functions_registry = _old_view_functions or {}

        def __getitem__(self, route_name):
            try:
                return NotARestApp._replaced_routes[route_name]
            except KeyError:
                return self._view_functions_registry[route_name]


    def actual_rest_app(self):
        if self._actual_rest_app is None:
            self._actual_rest_app, _keystore = make_rest_app(db_filepath="no datastore",
                          this_node=self.this_node,
                          serving_domains=(None,))
            _new_view_functions = self._ViewFunctions(self._actual_rest_app.view_functions)
            self._actual_rest_app.view_functions = _new_view_functions
            self._actual_rest_apps.append(self._actual_rest_app)  # Remember now, we're appending to the class-bound list.
        return self._actual_rest_app

    def test_client(self):
        rest_app = self.actual_rest_app()
        return rest_app.test_client()


class VerificationTracker:
    node_verifications = 0
    metadata_verifications = 0

    @classmethod
    def fake_verify_node(cls, *args, **kwargs):
        cls.node_verifications += 1

    @classmethod
    def fake_verify_metadata(cls, *args, **kwargs):
        cls.metadata_verifications += 1


mock_cert_generation = patch("nucypher.keystore.keypairs.generate_self_signed_certificate", new=do_not_create_cert)
mock_rest_app_creation = patch("nucypher.characters.lawful.make_rest_app",
                               new=lambda *args, **kwargs: (NotARestApp(), "this is not a datastore"))
mock_secret_source = patch("nucypher.keystore.keypairs.Keypair._private_key_source",
                           new=lambda *args, **kwargs: NotAPrivateKey())

mock_remember_node = patch("nucypher.characters.lawful.Ursula.remember_node", new=simple_remember)
mock_verify_node = patch("nucypher.characters.lawful.Ursula.verify_node", new=VerificationTracker.fake_verify_node)

mock_metadata_validation = patch("nucypher.network.nodes.Teacher.validate_metadata",
                                 new=VerificationTracker.fake_verify_metadata)

mock_pubkey_from_bytes = patch('umbral.keys.UmbralPublicKey.from_bytes', NotAPublicKey.from_bytes)
mock_stamp_call = patch('nucypher.crypto.signing.SignatureStamp.__call__', new=NotAPrivateKey.stamp)
mock_signature_bytes = patch('umbral.signing.Signature.__bytes__', new=NotAPrivateKey.signature_bytes)
